<!DOCTYPE html>
<html>
<head>
  <title>Socket.IO Example</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.3.2/socket.io.js"></script>
  <script>
    const socket = io('http://localhost:4000'); // Connect to the server
    let room = "";

    socket.on('message', (data) => {
      console.log('Received message:', data);
    });

    socket.on('roomMessage', (data) => {
      console.log('Received message from room:', data);
    });

    function sendMessage() {
      let message = document.getElementById('message').value;
      console.log("trying to send message ", message);
      socket.emit('roomMessage', { room: room, message: message });
    }

    function joinRoom() {
      let message = document.getElementById('room').value;
      room = message;
      socket.emit('joinRoom', message);
    }

    function createGame() {
      const url = 'http://localhost:4000/game/createGame';
      const body = {
        boardId: '1',
        createdBy: '1',
        status: 'ACTIVE',
        lastTurn: 1,
        numberOfPlayers: 4
      };
      const headers = {
        'Content-Type': 'application/json',
        'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyTmFtZSI6Im1vbW8yIiwicGFzc3dvcmQiOiIkMmEkMTAkYmVmUnpiTE9QNkp0dXpmdUE2TS4zLmpIQnFXYlFqakdhQ2dCM0RjTjdnRWU0ZnRsYWFobUsiLCJpYXQiOjE2ODg5NzkyODh9.v8Jjz6c21eF7t30xPlHCeokm32uaecv-jZLQ6o-Wl50'
      };

      fetch(url, {
        method: 'POST',
        headers: headers,
        body: JSON.stringify(body)
      })
        .then(response => response.json())
        .then(data => {
          console.log('Game created:', data);
          // Connect to the Socket.IO server after creating the game
          socket.connect();
        })
        .catch(error => {
          console.error('Error creating game:', error);
        });
    }
  </script>
</head>
<body>
  <input type="text" id="message" placeholder="Enter a message">
  <button onclick="sendMessage()">Send</button>

  <input type="text" id="room" placeholder="Join Room">
  <button onclick="joinRoom()">Join</button>

  <button onclick="createGame()">Create Game</button>
</body>
</html>
